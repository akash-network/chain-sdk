syntax = "proto3";
package akash.market.v1beta5;

import "gogoproto/gogo.proto";

import "cosmos/base/v1beta1/coin.proto";
import "akash/base/resources/v1beta4/resources.proto";
import "akash/base/resources/v1beta4/endpoint.proto";

option go_package = "pkg.akt.dev/go/node/market/v1beta5";

// StorageOfferPrice represents the price a provider is offering for a specific
// class of persistent storage. Providers may offer multiple storage classes
// (e.g., SSD, HDD, NVMe), each identified by name and priced independently.
// This type is used as a repeated field within OfferPrices to express
// per-class storage pricing in a bid.
message StorageOfferPrice {
  option (gogoproto.equal) = true;

  // Name holds an arbitrary name for the storage class (e.g., "default", "ssd", "hdd").
  // This must match a storage class name from the corresponding resource specification.
  string name = 1 [
    (gogoproto.jsontag)  = "name",
    (gogoproto.moretags) = "yaml:\"name\""
  ];

  // Price is the offered price per unit of this storage class, expressed as a
  // DecCoin (decimal coin) to allow fractional pricing. When nil, no explicit
  // price is set for this storage class.
  cosmos.base.v1beta1.DecCoin price = 2 [
    (gogoproto.nullable) = true,
    (gogoproto.jsontag)  = "price",
    (gogoproto.moretags) = "yaml:\"price\""
  ];
}

// EndpointOfferPrice represents the price a provider is offering for a specific
// kind of network endpoint. Providers may price each endpoint kind differently
// (e.g., a leased IP may cost more than a shared HTTP ingress). This type is
// used as a repeated field within OfferPrices to express per-kind endpoint
// pricing in a bid.
message EndpointOfferPrice {
  option (gogoproto.equal) = true;

  // Kind specifies the type of network endpoint being priced. Possible values:
  //   - SHARED_HTTP (0): A Kubernetes Ingress endpoint.
  //   - RANDOM_PORT (1): A Kubernetes NodePort endpoint.
  //   - LEASED_IP   (2): A dedicated leased IP endpoint.
  akash.base.resources.v1beta4.Endpoint.Kind kind = 1 [
    (gogoproto.jsontag)  = "kind",
    (gogoproto.moretags) = "yaml:\"kind\""
  ];

  // Price is the offered price per unit of this endpoint kind, expressed as a
  // DecCoin (decimal coin) to allow fractional pricing. When nil, no explicit
  // price is set for this endpoint kind.
  cosmos.base.v1beta1.DecCoin price = 2 [
    (gogoproto.nullable) = true,
    (gogoproto.jsontag)  = "price",
    (gogoproto.moretags) = "yaml:\"price\""
  ];
}

// OfferPrices contains the complete pricing breakdown that a provider includes
// in a bid for a deployment resource group. Each field represents the price for
// a specific compute resource type. All price fields use DecCoin (decimal coin)
// to support fractional pricing denominated in any supported token.
//
// This message is embedded as a nullable field on ResourceOffer, which in turn
// is carried by Bid and MsgCreateBid messages. A nil OfferPrices on a
// ResourceOffer indicates that no per-resource pricing was specified.
//
// Field 1 is reserved for backward compatibility with a previously removed field.
message OfferPrices {
  option (gogoproto.equal) = true;

  reserved 1;

  // Cpu is the offered price for CPU resources. When nil, no explicit
  // CPU price is set.
  cosmos.base.v1beta1.DecCoin cpu = 2 [
    (gogoproto.nullable) = true,
    (gogoproto.jsontag)  = "cpu",
    (gogoproto.moretags) = "yaml:\"cpu\""
  ];

  // Memory is the offered price for memory resources. When nil, no explicit
  // memory price is set.
  cosmos.base.v1beta1.DecCoin memory = 3 [
    (gogoproto.nullable) = true,
    (gogoproto.jsontag)  = "memory",
    (gogoproto.moretags) = "yaml:\"memory\""
  ];

  // Storage is a list of per-class storage prices. Each entry corresponds to a
  // named storage class (e.g., "default", "ssd") and its associated price.
  // Multiple entries allow providers to price different storage tiers independently.
  repeated StorageOfferPrice storage = 4 [
    (gogoproto.jsontag)  = "storage",
    (gogoproto.moretags) = "yaml:\"storage\""
  ];

  // Gpu is the offered price for GPU resources. When nil, no explicit
  // GPU price is set.
  cosmos.base.v1beta1.DecCoin gpu = 5 [
    (gogoproto.nullable) = true,
    (gogoproto.jsontag)  = "gpu",
    (gogoproto.moretags) = "yaml:\"gpu\""
  ];

  // Endpoints is a list of per-kind endpoint prices. Each entry corresponds to
  // a network endpoint kind (SHARED_HTTP, RANDOM_PORT, or LEASED_IP) and its
  // associated price. Multiple entries allow providers to price different
  // endpoint types independently.
  repeated EndpointOfferPrice endpoints = 6 [
    (gogoproto.jsontag)  = "endpoints",
    (gogoproto.moretags) = "yaml:\"endpoints\""
  ];
}

// ResourceOffer describes resources that provider is offering
// for deployment.
message ResourceOffer {
  option (gogoproto.equal) = true;
  // Resources holds information about bid resources.
  akash.base.resources.v1beta4.Resources resources = 1 [
    (gogoproto.nullable)   = false,
    (gogoproto.jsontag)    = "resources",
    (gogoproto.moretags)   = "yaml:\"resources\""
  ];

  // Count is the number of resources.
  uint32 count = 2 [
    (gogoproto.jsontag)  = "count",
    (gogoproto.moretags) = "yaml:\"count\""
  ];

  // Prices contains per-resource pricing details (CPU, memory, storage, GPU, endpoints) for this offer.
  OfferPrices prices = 3 [
    (gogoproto.nullable)   = true,
    (gogoproto.jsontag)    = "prices",
    (gogoproto.moretags)   = "yaml:\"prices\""
  ];
}
